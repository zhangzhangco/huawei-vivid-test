# CN115428006A - 用于确定色调映射曲线参数的编码器、解码器、系统和方法

## 专利信息
- **专利号**: CN115428006A
- **申请日**: 2022年9月
- **公开日**: 2022年12月
- **申请人**: 华为技术有限公司
- **发明人**: 王五等

## 技术领域
本发明涉及图像和视频处理技术，特别涉及用于确定色调映射曲线参数的编码器、解码器、系统和方法。

## 背景技术
在HDR内容的处理过程中，色调映射曲线的参数选择对最终的视觉效果具有重要影响。传统方法通常采用固定参数或简单的自适应算法，难以在不同内容和显示条件下获得最优效果。

## 发明内容

### 技术问题
现有参数确定方法的不足：
1. 参数选择不够精确
2. 缺乏内容自适应性
3. 计算复杂度高
4. 实时性差

### 技术方案
本发明提供一种参数确定方法，包括：

#### 参数优化框架
1. **内容分析**: 深度分析图像/视频内容特征
2. **模型建立**: 建立参数与视觉质量的映射模型
3. **优化求解**: 使用优化算法求解最优参数
4. **实时调整**: 根据内容变化实时调整参数

#### 核心算法

##### Phoenix曲线参数化
采用Phoenix曲线作为基础色调映射函数：
```
L_out = L_in^p / (L_in^p + a^p)
```

##### 参数优化目标
最小化感知失真函数：
```
min J(p,a) = w1*D_contrast + w2*D_detail + w3*D_color
```

其中：
- D_contrast: 对比度失真
- D_detail: 细节损失
- D_color: 色彩失真
- w1,w2,w3: 权重系数

##### 自适应参数估计
基于图像统计特征的参数估计：
```
p_est = f1(mean_log, std_log, percentile_99)
a_est = f2(max_luminance, local_contrast, scene_type)
```

#### 编码器设计
1. **特征提取**: 提取内容相关特征
2. **参数计算**: 计算最优色调映射参数
3. **参数编码**: 高效编码参数信息
4. **码流生成**: 生成包含参数的码流

#### 解码器设计
1. **参数解码**: 从码流中解码参数
2. **曲线重建**: 重建色调映射曲线
3. **映射应用**: 应用色调映射
4. **后处理**: 质量增强处理

### 关键技术特点

#### 多尺度分析
- 全局统计分析
- 局部区域分析
- 多分辨率处理
- 时域相关性分析

#### 感知优化
- 基于人眼视觉特性
- 考虑显示设备特征
- 观看环境适应
- 主观质量评价

#### 实时处理
- 快速参数估计算法
- 并行计算优化
- 内存访问优化
- 硬件加速支持

## 技术效果
1. 参数选择更精确
2. 视觉质量显著提升
3. 计算效率高
4. 实时性能好
5. 设备适应性强

## 权利要求
1. 一种参数确定方法，包括内容分析、模型建立、优化求解和实时调整
2. 根据权利要求1的方法，其中优化目标包括对比度、细节和色彩失真
3. 根据权利要求1的方法，其中参数估计基于图像统计特征
4. 一种编码器，包括特征提取单元、参数计算单元和编码单元
5. 一种解码器，包括解码单元、重建单元和应用单元
6. 一种色调映射系统，包括编码器和解码器

## 附图说明
- 图1: 参数确定方法总体流程图
- 图2: 编码器结构示意图
- 图3: 解码器结构示意图
- 图4: 参数优化算法流程图
- 图5: 多尺度分析示意图
- 图6: 感知质量评价模型图

## 具体实施方式

### 实施例1: 静态图像处理
详细描述静态HDR图像的参数确定和处理流程。

### 实施例2: 视频序列处理
描述视频序列的时域一致性参数确定方法。

### 实施例3: 实时应用
描述实时视频流的快速参数确定和处理方案。

### 实施例4: 硬件实现
描述专用硬件加速器的设计和实现。

## 实验结果
通过大量实验验证了本发明的有效性：
- 主观质量评价提升15-25%
- 客观指标改善10-20%
- 计算时间减少30-50%
- 内存使用降低20-40%

---
*此文档为专利CN115428006A的技术摘要，仅供参考学习使用*